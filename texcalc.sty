\ProvidesPackage{texcalc}
\RequirePackage{comment} % for calc
\RequirePackage{environ} % for calc 
\RequirePackage{fancyvrb} % for calc


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TeXCalc \val{x} and \val[1]{y}
\newcommand{\val}[2][2]{
	\ensuremath{
			\immediate\write18{texcalc.py -job '\jobname' #2 #1 > \jobname.calc.res}
			\immediate\input\jobname.calc.res
	} 
} % do nothing  

%\ifnum\pdfshellescape=1
%% Yes, write18,  enabled
%\else
%% No, disabled
%\fi

% \ifx\directlua\pgf@gd@undefined@donotuse{ DO CLASSIC }\else{ DO LUA }\fi
% \directlue{os.execute("echo hallo")}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Write all the begin calcs down to a file 
\newcounter{@CalcCounter}
\immediate\write18{rm \jobname.calc.*.py}

% TeXCalc Environment
\newenvironment{calc}{
\stepcounter{@CalcCounter}
\VerbatimOut{\jobname.calc.\the@CalcCounter.py}}  
{\endVerbatimOut}


